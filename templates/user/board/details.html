{% extends 'layout/primary.html' %} {% block content %}
<div class="p-6 max-w-6xl mx-auto">
  <div class="mb-10 pb-8 border-b border-slate-800">
    <div class="mb-6 border-b border-slate-800 pb-2 flex justify-between items-center">
      {% include 'user/board/_name_display.html' %}
      <button
        hx-delete="{{ url_for('user.delete_board', board_id=board.id) }}"
        hx-confirm="Are you sure you want to delete this board? This action cannot be undone."
        hx-target="body"
        hx-push-url="{{ url_for('app.home') }}"
        class="font-['Press_Start_2P'] text-[10px] bg-slate-800 border-2 border-slate-700 p-2 text-white hover:bg-pico-red hover:text-black hover:border-pico-red transition-all"
      >
        Delete Board
      </button>
    </div>

    <div class="flex flex-wrap gap-x-12 gap-y-6">
      <div>
        <h3
          class="text-slate-500 uppercase text-[10px] font-bold tracking-widest mb-1"
        >
          Hardware Type
        </h3>
        <p class="text-sm text-slate-200">{{ board.boardType }}</p>
      </div>
      <div>
        <h3
          class="text-slate-500 uppercase text-[10px] font-bold tracking-widest mb-1"
        >
          Board UUID
        </h3>
        <p class="text-sm font-mono text-slate-400">{{ board.id }}</p>
      </div>
      <div>
        <h3
          class="text-slate-500 uppercase text-[10px] font-bold tracking-widest mb-1"
        >
          Security Lifecycle
        </h3>
        <p class="text-sm text-slate-400">
          Key rotated: {{ board.secret_updated_at|time_ago }}
        </p>
      </div>
    </div>
  </div>

  <div class="flex flex-wrap gap-12 items-start">
    <div class="flex flex-col gap-8 w-full md:w-auto max-w-full shrink-0">
      <div
        class="flex justify-center bg-slate-900 p-6 rounded-md border border-slate-700 shadow-xl overflow-hidden"
      >
        <pixel-art
          class="max-w-full h-auto"
          src="{{ url_for('static', filename='img/' ~ board.boardType|lower ~ '.png') }}"
          alt="{{ board.boardType }}"
        >
        </pixel-art>
      </div>

      <div class="bg-slate-900/50 p-4 rounded-md border border-slate-800/50">
        {% include 'user/board/status_indicator.html' %}
      </div>
    </div>

    <div
      id="setup-area"
      class="flex-1 min-w-[300px] lg:min-w-[450px] bg-slate-900/50 rounded-md border border-slate-800 p-8 shadow-inner"
    >
      <h2 class="text-xl font-bold text-white mb-4 uppercase tracking-tight">
        Device Provisioning
      </h2>
      <p class="text-slate-400 text-sm mb-6 leading-relaxed">
        To connect your Raspberry Pi Pico to the PMB network, you must generate
        a unique secret key and include it in your <code>secrets.py</code> file.
      </p>

      <button
        hx-post="{{ url_for('auth.register_board', board_id=board.id) }}"
        hx-target="#setup-area"
        hx-swap="innerHTML"
        class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-lg shadow-blue-900/40 w-full sm:w-auto"
      >
        {% if board.secret_key_hash %}Regenerate Access Key{% else %}Generate
        Access Key{% endif %}
      </button>
    </div>
  </div>
</div>
{% endblock %}
